# 增强版消息安全配置模板

# Kafka安全配置
kafka.security.protocol=SASL_SSL
kafka.sasl.mechanism=PLAIN
kafka.sasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username="admin" password="admin-secret";
kafka.ssl.truststore.location=/path/to/truststore.jks
kafka.ssl.truststore.password=password
kafka.ssl.keystore.location=/path/to/keystore.jks
kafka.ssl.keystore.password=password
kafka.authorizer.class.name=kafka.security.authorizer.AclAuthorizer
kafka.allow.everyone.if.no.acl.found=false

# NATS安全配置
nats.tls.enabled=true
nats.tls.cert.file=/path/to/cert.pem
nats.tls.key.file=/path/to/key.pem
nats.tls.ca.file=/path/to/ca.pem
nats.auth.enabled=true
nats.auth.user=admin
nats.auth.password=admin-secret
nats.auth.token=token-secret

# RabbitMQ安全配置
rabbitmq.ssl.enabled=true
rabbitmq.ssl.cert.file=/path/to/cert.pem
rabbitmq.ssl.key.file=/path/to/key.pem
rabbitmq.ssl.ca.file=/path/to/ca.pem
rabbitmq.auth.enabled=true
rabbitmq.auth.default_user=admin
rabbitmq.auth.default_pass=admin-secret
rabbitmq.auth.password_hashing.algorithm=sha256

# 通用安全配置
security.encryption.enabled=true
security.encryption.algorithm=AES-256-GCM
security.encryption.key.rotation.enabled=true
security.encryption.key.rotation.interval=90d

# 认证配置
auth.type=ldap  # ldap/oauth2/jwt/custom
auth.ldap.url=ldap://ldap.example.com:389
auth.ldap.base_dn=dc=example,dc=com
auth.ldap.user_dn=cn=admin,dc=example,dc=com
auth.ldap.password=password

# 授权配置
authorization.type=rbac  # rbac/abac/acl
authorization.rbac.enabled=true
authorization.rbac.roles=admin,user,guest
authorization.rbac.permissions=read,write,delete,admin

# 审计配置
audit.enabled=true
audit.log.file=/var/log/mq-audit.log
audit.log.level=INFO
audit.events=login,logout,read,write,delete,config_change
audit.retention.days=90

# 合规配置
compliance.gdpr.enabled=true
compliance.gdpr.data_retention.days=365
compliance.gdpr.data_deletion.enabled=true
compliance.hipaa.enabled=false
compliance.pci_dss.enabled=false

# 安全监控配置
security.monitor.enabled=true
security.monitor.failed_login.threshold=5
security.monitor.failed_login.window=300  # 5分钟
security.monitor.alert.channels=email,dingtalk

# 密钥管理配置
key.management.enabled=true
key.management.provider=vault  # vault/kms/custom
key.management.vault.url=http://vault:8200
key.management.vault.token=token
key.management.rotation.enabled=true
key.management.rotation.interval=90d
