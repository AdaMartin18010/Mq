# 消息限流配置模板

# Producer限流配置
rate.limit.producer.enabled=true
rate.limit.producer.strategy=token_bucket  # fixed_window/sliding_window/token_bucket
rate.limit.producer.rate.per.second=1000  # 每秒1000条
rate.limit.producer.burst.size=2000  # 突发流量2000条
rate.limit.producer.max.in.flight.requests=5
rate.limit.producer.batch.size=16384
rate.limit.producer.linger.ms=10

# Consumer限流配置
rate.limit.consumer.enabled=true
rate.limit.consumer.strategy=token_bucket  # fixed_window/sliding_window/token_bucket
rate.limit.consumer.rate.per.second=1000  # 每秒1000条
rate.limit.consumer.burst.size=2000  # 突发流量2000条
rate.limit.consumer.fetch.min.bytes=1
rate.limit.consumer.fetch.max.wait.ms=500
rate.limit.consumer.max.partition.fetch.bytes=1048576
rate.limit.consumer.max.poll.records=500
rate.limit.consumer.prefetch.count=10

# 全局限流配置
rate.limit.global.enabled=true
rate.limit.global.strategy=token_bucket
rate.limit.global.rate.per.second=10000  # 全局每秒10000条
rate.limit.global.burst.size=20000

# 分区限流配置
rate.limit.partition.enabled=true
rate.limit.partition.strategy=token_bucket
rate.limit.partition.rate.per.second=1000  # 每个分区每秒1000条
rate.limit.partition.burst.size=2000

# 用户限流配置
rate.limit.user.enabled=true
rate.limit.user.strategy=token_bucket
rate.limit.user.rate.per.second=100  # 每个用户每秒100条
rate.limit.user.burst.size=200
rate.limit.user.quota.enabled=true
rate.limit.user.quota.daily=1000000  # 每天100万条

# 限流处理策略配置
rate.limit.handling.strategy=wait  # reject/wait/degrade
rate.limit.handling.wait.timeout.ms=1000  # 等待超时1秒
rate.limit.handling.degrade.enabled=false
rate.limit.handling.degrade.strategy=skip  # skip/retry_later

# 多租户限流配置
rate.limit.multitenant.enabled=true
rate.limit.multitenant.strategy=per_tenant  # per_tenant/shared
rate.limit.multitenant.per.tenant.rate=1000
rate.limit.multitenant.shared.rate=10000
rate.limit.multitenant.priority.enabled=true
rate.limit.multitenant.priority.levels=3  # 高/中/低优先级

# 限流监控配置
rate.limit.monitor.enabled=true
rate.limit.monitor.metrics=rate_limit_rate,rate_limit_rejected,rate_limit_waiting
rate.limit.monitor.alert.enabled=true
rate.limit.monitor.alert.rejected.rate.threshold=0.1  # 10%拒绝率告警
rate.limit.monitor.alert.waiting.count.threshold=1000  # 1000条等待告警

# 限流自动调整配置
rate.limit.auto.adjust.enabled=false
rate.limit.auto.adjust.strategy=adaptive  # adaptive/fixed
rate.limit.auto.adjust.interval.minutes=5
rate.limit.auto.adjust.min.rate=100
rate.limit.auto.adjust.max.rate=10000
rate.limit.auto.adjust.target.rejected.rate=0.05  # 目标拒绝率5%
