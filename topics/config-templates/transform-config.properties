# 消息转换配置模板

# Kafka转换配置
kafka.connect.transform.enabled=true
kafka.connect.transform.type=org.apache.kafka.connect.transforms.Convert
kafka.streams.transform.enabled=true
kafka.streams.transform.operator=map  # map/filter/flatMap
kafka.streams.transform.async.enabled=false

# NATS转换配置
nats.transform.enabled=true
nats.transform.type=format  # format/content/route
nats.transform.format.from=json
nats.transform.format.to=protobuf
nats.transform.async.enabled=false

# RabbitMQ转换配置
rabbitmq.transform.enabled=true
rabbitmq.transform.type=format  # format/content/route
rabbitmq.transform.format.from=json
rabbitmq.transform.format.to=protobuf
rabbitmq.transform.exchange.from=input-exchange
rabbitmq.transform.exchange.to=output-exchange

# 格式转换配置
transform.format.enabled=true
transform.format.from=json  # json/xml/protobuf/avro
transform.format.to=protobuf  # json/xml/protobuf/avro
transform.format.schema.registry.url=http://localhost:8081

# 内容转换配置
transform.content.enabled=true
transform.content.field.mapping.enabled=true
transform.content.field.mapping.file=/etc/mq/field-mapping.json
transform.content.data.cleaning.enabled=true
transform.content.data.enhancement.enabled=true

# 路由转换配置
transform.route.enabled=true
transform.route.topic.mapping.enabled=true
transform.route.topic.mapping.file=/etc/mq/topic-mapping.json
transform.route.routing.key.mapping.enabled=true

# 协议适配配置
adapter.enabled=true
adapter.type=kafka-to-rabbitmq  # kafka-to-rabbitmq/nats-to-kafka/custom
adapter.source.type=kafka
adapter.source.brokers=localhost:9092
adapter.target.type=rabbitmq
adapter.target.host=localhost
adapter.target.port=5672

# 转换性能优化
transform.optimization.enabled=true
transform.optimization.cache.enabled=true
transform.optimization.cache.size=10000
transform.optimization.cache.ttl=300  # 5分钟
transform.optimization.batch.enabled=true
transform.optimization.batch.size=100
transform.optimization.async.enabled=false

# 转换监控配置
transform.monitor.enabled=true
transform.monitor.metrics=transform_count,transform_latency,transform_errors,transform_throughput
transform.monitor.alert.enabled=true
transform.monitor.alert.error.threshold=0.01  # 1%错误率
transform.monitor.alert.latency.threshold=1000  # 1秒延迟

# 转换错误处理
transform.error.handling.enabled=true
transform.error.handling.strategy=dlq  # dlq/retry/ignore
transform.error.handling.dlq.topic=transform-dlq
transform.error.handling.retry.max.attempts=3
transform.error.handling.retry.backoff.ms=1000
